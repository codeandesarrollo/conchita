<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Catálogo | Conchita Florestería</title>
  <meta name="description" content="Compra ramos y arreglos en Conchita Florestería. Agrega al carrito y finaliza tu pedido." />
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
  <style>
    :root{
      --rosa:#d4af37; --rosa-osc:#b9931f; --crema:#0d0d0d;
      --verde:#d4af37; --texto:#e9e9e9; --gris:#b3b3b3; --bordes:#2a2a2a; --panel:#121212;
    }
    *{box-sizing:border-box} html,body{margin:0} a{text-decoration:none;color:inherit}
    body{
      font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,sans-serif;color:var(--texto);
      background:
        radial-gradient(1200px 400px at -10% -10%, rgba(212,175,55,.08), transparent 60%),
        radial-gradient(1000px 380px at 110% -20%, rgba(212,175,55,.06), transparent 60%),
        linear-gradient(180deg,#0b0b0b,#141414);
    }
    .container{width:min(1200px,92%);margin-inline:auto}
    header{position:sticky;top:0;z-index:50;background:rgba(0,0,0,.65);backdrop-filter:blur(8px);border-bottom:1px solid var(--bordes)}
    .navbar{display:flex;align-items:center;justify-content:space-between;padding:.9rem 0}
    .brand{display:flex;align-items:center;gap:.6rem;font-weight:700}
    .brand .logo{width:36px;height:36px;border-radius:50%;background:radial-gradient(circle at 30% 30%,#d4af37,#8a6b1b)}
    nav ul{display:flex;list-style:none;gap:1rem;padding:0;margin:0;align-items:center}
    .btn{
      display:inline-flex;align-items:center;gap:.4rem;padding:.7rem 1rem;border-radius:999px;border:1px solid var(--bordes);
      background:transparent;font-weight:600;color:var(--texto);cursor:pointer;transition:transform .05s ease, background .2s ease, border-color .2s ease
    }
    .btn:hover{border-color:#3a3a3a}
    .btn-rosa{background:var(--rosa);color:#111;border-color:transparent}
    .btn-rosa:hover{background:var(--rosa-osc)}
    .cart-pill{display:inline-flex;align-items:center;gap:.45rem;padding:.45rem .8rem;border-radius:999px;background:#0f0f0f;border:1px solid var(--bordes)}
    .cart-count{background:var(--rosa);color:#111;font-size:.75rem;min-width:1.35rem;height:1.35rem;display:inline-grid;place-items:center;border-radius:999px;font-weight:700}

    .section{padding:1.6rem 0 2.2rem}
    .toolbar{display:flex;gap:.8rem;align-items:center;justify-content:space-between;margin-bottom:1rem;flex-wrap:wrap}
    .title{font-family:'Playfair Display',serif;font-size:clamp(1.6rem,2.3vw,2rem);margin:0}
    .search{flex:1;display:flex;background:#0f0f0f;border:1px solid var(--bordes);border-radius:999px;overflow:hidden;min-width:240px}
    .search input{flex:1;border:0;padding:.8rem 1rem;outline:none;background:transparent;color:var(--texto)}
    .search input::placeholder{color:#8a8a8a}
    .chips{display:flex;gap:.5rem;flex-wrap:wrap}
    .chip{border:1px solid var(--bordes);border-radius:999px;padding:.4rem .8rem;background:#0f0f0f;color:var(--texto);cursor:pointer}
    .chip.active{background:var(--rosa);color:#111;border-color:transparent}

    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:1rem}
    @media (max-width:1100px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media (max-width:800px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:520px){.grid{grid-template-columns:1fr}}
    .card{background:var(--panel);border:1px solid var(--bordes);border-radius:18px;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 8px 20px rgba(0,0,0,.25)}
    .card-img{aspect-ratio:4/3;background:#1a1a1a center/cover no-repeat}
    .card-body{padding:1rem;display:flex;flex-direction:column;gap:.5rem;flex:1}
    .price{font-weight:700;color:var(--verde)}
    .muted{color:var(--gris);font-size:.9rem}
    .card-actions{margin-top:auto;display:flex;gap:.6rem}

    /* Drawer carrito */
    .drawer{position:fixed;top:0;right:0;height:100dvh;width:min(420px,95%);background:#0f0f0f;border-left:1px solid var(--bordes);box-shadow:-12px 0 30px rgba(0,0,0,.4);transform:translateX(100%);transition:transform .25s ease;z-index:60;display:flex;flex-direction:column;color:var(--texto)}
    .drawer.open{transform:translateX(0)}
    .drawer-header{display:flex;align-items:center;justify-content:space-between;padding:1rem;border-bottom:1px solid var(--bordes);background:#111}
    .drawer-body{padding:1rem;overflow:auto;flex:1}
    .linea{display:grid;grid-template-columns:64px 1fr auto;gap:.8rem;align-items:center;padding:.6rem 0;border-bottom:1px dashed #333}
    .linea:last-child{border-bottom:0}
    .thumb{width:64px;height:64px;border-radius:10px;background:#1a1a1a center/cover no-repeat;border:1px solid #222}
    .qty{width:64px;padding:.35rem .5rem;border:1px solid var(--bordes);border-radius:10px;text-align:center;background:#0f0f0f;color:var(--texto)}
    .total{display:flex;align-items:center;justify-content:space-between;font-weight:700;padding:0 1rem 1rem;color:var(--verde)}
    .drawer-footer{border-top:1px solid var(--bordes);padding:1rem;display:grid;gap:.6rem;background:#111}
    .toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%) translateY(20px);background:#111;color:#fff;padding:.8rem 1rem;border-radius:12px;opacity:0;transition:all .25s ease;z-index:70}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
  </style>
</head>
<body>
  <header>
    <div class="container navbar">
      <a class="brand" href="index.html"><span class="logo" aria-hidden="true"></span><span>Conchita Florestería</span></a>
      <nav>
        <ul>
          <li><a class="btn" href="index.html"><i class="bi bi-house"></i> Información</a></li>
          <li><button id="toggleCart" class="cart-pill"><i class="bi bi-bag-heart"></i> <span>Carrito</span> <span id="cartCount" class="cart-count">0</span></button></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="container section">
    <div class="toolbar">
      <h1 class="title">Catálogo</h1>
      <div class="chips" id="chips"></div>
      <label class="search" aria-label="Buscar productos">
        <i class="bi bi-search" style="padding-left:.9rem;align-self:center"></i>
        <input id="buscador" type="search" placeholder="Buscar por nombre o categoría…" />
      </label>
    </div>

    <div id="gridProductos" class="grid" aria-live="polite"></div>
  </main>

  <!-- Drawer Carrito -->
  <aside id="drawer" class="drawer" aria-label="Carrito de compras" aria-hidden="true">
    <div class="drawer-header">
      <strong><i class="bi bi-bag"></i> Tu carrito</strong>
      <div style="display:flex;gap:.5rem;align-items:center">
        <button id="btnVaciar" class="btn"><i class="bi bi-trash3"></i> Vaciar</button>
        <button id="btnCerrar" class="btn"><i class="bi bi-x-lg"></i> Cerrar</button>
      </div>
    </div>
    <div id="lista" class="drawer-body"></div>
    <div class="total"><span>Total</span><strong id="total">$0.00</strong></div>
    <div class="drawer-footer">
      <button id="btnPagar" class="btn btn-rosa"><i class="bi bi-credit-card-2-front"></i> Finalizar compra</button>
      <small class="muted">Agrega indicaciones (mensaje en tarjeta, horario, referencias) en el paso de confirmación.</small>
    </div>
  </aside>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <script>
    // ======= Utilidades carrito =======
    const STORAGE_KEY='conchita_cart';
    const money=v=>v.toLocaleString('es-MX',{style:'currency',currency:'MXN'});
    const getCart=()=>{try{return JSON.parse(localStorage.getItem(STORAGE_KEY))||[]}catch{return[]}};
    const setCart=c=>localStorage.setItem(STORAGE_KEY,JSON.stringify(c));
    const updateCartCount=()=>{
      const count=getCart().reduce((a,b)=>a+b.qty,0);
      const el=document.getElementById('cartCount'); if(el) el.textContent=count;
    };
    const toast=msg=>{const t=document.getElementById('toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1600)};

    const addToCart=item=>{
      const cart=getCart();
      const i=cart.findIndex(p=>p.id===item.id);
      if(i>=0){cart[i].qty+=(item.qty||1)} else {cart.push({id:item.id,nombre:item.nombre,precio:item.precio,imagen:item.imagen,qty:item.qty||1})}
      setCart(cart); updateCartCount(); renderCart(); toast(`Agregado: ${item.nombre}`);
    };

    // ======= Datos de productos (demo) =======
    const productos=[
      {id:'ramo-rosas-24',nombre:'Ramo de Rosas (24)',precio:899,categoria:'Rosas',imagen:'https://images.unsplash.com/photo-1509043759401-136742328bb3?q=80&w=1200&auto=format&fit=crop',desc:'Clásico y elegante, incluye tarjeta.'},
      {id:'caja-sorpresa',nombre:'Caja Sorpresa Floral',precio:1050,categoria:'Arreglos',imagen:'https://images.unsplash.com/photo-1520848315518-b991dd16a6cf?q=80&w=1200&auto=format&fit=crop',desc:'Caja premium con flores mixtas.'},
      {id:'suculenta-mini',nombre:'Suculenta Mini',precio:149,categoria:'Plantas',imagen:'https://images.unsplash.com/photo-1501004318641-b39e6451bec6?q=80&w=1200&auto=format&fit=crop',desc:'Maceta de cerámica.'},
      {id:'tulipanes-amarillos',nombre:'Tulipanes Amarillos (12)',precio:790,categoria:'Ramos',imagen:'https://images.unsplash.com/photo-1464965911861-746a04b4bca6?q=80&w=1200&auto=format&fit=crop',desc:'Frescos y luminosos.'},
      {id:'centro-mesa',nombre:'Centro de Mesa Eucalipto',precio:1120,categoria:'Eventos',imagen:'https://images.unsplash.com/photo-1496062031456-07b8f162a322?q=80&w=1200&auto=format&fit=crop',desc:'Ideal para cenas y eventos.'},
      {id:'rosas-azules',nombre:'Rosas Azules (12)',precio:920,categoria:'Rosas',imagen:'https://images.unsplash.com/photo-1490902931801-d6f80ca94fe1?q=80&w=1200&auto=format&fit=crop',desc:'Toque único y sofisticado.'},
      {id:'orquidea-blanca',nombre:'Orquídea Blanca',precio:1290,categoria:'Plantas',imagen:'https://images.unsplash.com/photo-1524708655429-3fbf9c07c5f6?q=80&w=1200&auto=format&fit=crop',desc:'Elegancia pura en maceta.'},
      {id:'ramo-mixto',nombre:'Ramo Mixto Primavera',precio:680,categoria:'Ramos',imagen:'https://images.unsplash.com/photo-1519681394381-10a715e2b7b7?q=80&w=1200&auto=format&fit=crop',desc:'Colores vibrantes.'}
    ];
    const categorias=["Todos","Ramos","Rosas","Plantas","Arreglos","Eventos"];

    // ======= UI Catálogo =======
    const grid=document.getElementById('gridProductos');
    const chips=document.getElementById('chips');
    const buscador=document.getElementById('buscador');
    let filtroCat='Todos';

    chips.innerHTML=categorias.map(c=>`<button class="chip${c==='Todos'?' active':''}" data-cat="${c}">${c}</button>`).join('');
    chips.querySelectorAll('.chip').forEach(ch=>{
      ch.addEventListener('click',()=>{
        filtroCat=ch.dataset.cat;
        chips.querySelectorAll('.chip').forEach(x=>x.classList.remove('active'));
        ch.classList.add('active');
        renderProductos();
      });
    });

    buscador.addEventListener('input',()=>renderProductos());

    function renderProductos(){
      const q=buscador.value.toLowerCase().trim();
      const lista=productos.filter(p=>{
        const matchTexto=(p.nombre+' '+p.categoria+' '+(p.desc||'')).toLowerCase().includes(q);
        const matchCat=(filtroCat==='Todos' || p.categoria===filtroCat);
        return matchTexto && matchCat;
      });
      grid.innerHTML=lista.map(p=>`
        <article class="card" aria-label="${p.nombre}">
          <div class="card-img" style="background-image:url('${p.imagen}')"></div>
          <div class="card-body">
            <strong>${p.nombre}</strong>
            <span class="muted">${p.categoria}</span>
            <span class="price">${money(p.precio)}</span>
            <p class="muted">${p.desc}</p>
            <div class="card-actions">
              <button class="btn btn-rosa" data-add="${p.id}"><i class="bi bi-bag-plus"></i> Agregar</button>
              <button class="btn" data-now="${p.id}"><i class="bi bi-lightning"></i> Comprar</button>
            </div>
          </div>
        </article>
      `).join('');
      grid.querySelectorAll('[data-add]').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const id=btn.getAttribute('data-add');
          const prod=productos.find(x=>x.id===id);
          addToCart({id:prod.id,nombre:prod.nombre,precio:prod.precio,imagen:prod.imagen,qty:1});
        });
      });
      grid.querySelectorAll('[data-now]').forEach(btn=>{
        btn.addEventListener('click',()=>{
          const id=btn.getAttribute('data-now');
          const prod=productos.find(x=>x.id===id);
          addToCart({id:prod.id,nombre:prod.nombre,precio:prod.precio,imagen:prod.imagen,qty:1});
          openDrawer();
        });
      });
    }

    // ======= Drawer Carrito =======
    const drawer=document.getElementById('drawer');
    const lista=document.getElementById('lista');
    const totalEl=document.getElementById('total');
    const toggleCart=document.getElementById('toggleCart');
    const btnCerrar=document.getElementById('btnCerrar');

    const openDrawer=()=>{drawer.classList.add('open');drawer.setAttribute('aria-hidden','false')};
    const closeDrawer=()=>{drawer.classList.remove('open');drawer.setAttribute('aria-hidden','true')};

    toggleCart.addEventListener('click',openDrawer);
    btnCerrar.addEventListener('click',closeDrawer);

    function renderCart(){
      const cart=getCart();
      updateCartCount();
      if(cart.length===0){
        lista.innerHTML=`<p class="muted" style="text-align:center">Tu carrito está vacío.</p>`;
        totalEl.textContent=money(0);
        return;
      }
      lista.innerHTML=cart.map((p,idx)=>`
        <div class="linea">
          <div class="thumb" style="background-image:url('${p.imagen||''}')"></div>
          <div>
            <div style="font-weight:600">${p.nombre}</div>
            <div class="muted">${money(p.precio)} c/u</div>
            <div style="display:flex;gap:.5rem;align-items:center;margin-top:.35rem">
              <label for="qty-${idx}" class="muted">Cantidad:</label>
              <input id="qty-${idx}" class="qty" type="number" min="1" step="1" value="${p.qty}" data-idx="${idx}">
              <button class="btn" data-del="${idx}" title="Quitar"><i class="bi bi-x-circle"></i></button>
            </div>
          </div>
          <div style="text-align:right;font-weight:700">${money(p.precio*p.qty)}</div>
        </div>
      `).join('');
      lista.querySelectorAll('input.qty').forEach(inp=>{
        inp.addEventListener('change',e=>{
          const idx=+e.target.dataset.idx;
          const val=Math.max(1,parseInt(e.target.value||'1',10));
          const c=getCart(); c[idx].qty=val; setCart(c); renderCart();
        });
      });
      lista.querySelectorAll('[data-del]').forEach(btn=>{
        btn.addEventListener('click',e=>{
          const idx=+e.currentTarget.getAttribute('data-del');
          const c=getCart(); c.splice(idx,1); setCart(c); renderCart();
        });
      });
      const total=cart.reduce((a,p)=>a+p.precio*p.qty,0);
      totalEl.textContent=money(total);
    }

    document.getElementById('btnVaciar').addEventListener('click',()=>{
      if(confirm('¿Vaciar carrito por completo?')){ setCart([]); renderCart(); }
    });
    document.getElementById('btnPagar').addEventListener('click',()=>{
      alert('Simulación de pago: aquí iría tu pasarela o formulario de confirmación.');
      // setCart([]); renderCart(); closeDrawer();
    });

    // Init
    renderProductos();
    renderCart();
    updateCartCount();
  </script>
</body>
</html>
